// Tracks net effect of current transform stack for p5.js (for mouse hover detection)
// file copy from https://github.com/ChristerNilsson/Transformer
// Generated by CoffeeScript 1.12.7
var Transformer;

Transformer = (function() {
  function Transformer(x, y, angle, scale, alpha, tintColor,  stack) {
    this.x = x != null ? x : 0;
    this.y = y != null ? y : 0;
    this.a = angle != null ? angle : 0;
    this.s = scale != null ? scale : 1;
    this.alpha = alpha != null ? alpha : 1;
    this.tintColor = tintColor != null ? tintColor : [1,1,1];
    this.stack = stack != null ? stack : [];
  }

  Transformer.prototype.push = function() {
    push();
    return this.stack.push([this.x, this.y, this.a, this.s, this.alpha, ...this.tintColor]);
  };

  Transformer.prototype.pop = function() {
    var ref;
    pop();
    return ref = this.stack.pop(), this.x = ref[0], this.y = ref[1], this.a = ref[2], this.s = ref[3], this.alpha = ref[4], this.tintColor[0] = ref[5], this.tintColor[1]=ref[6], this.tintColor[2] = ref[7], ref;
  };

  Transformer.prototype.rotate = function(da) {
    rotate(da);
    return this.a += da;
  };

  Transformer.prototype.scale = function(ds) {
    scale(ds);
    return this.s *= ds;
  };

  Transformer.prototype.translate = function(dx, dy) {
    translate(dx, dy);
    this.x += this.s * dx * cos(this.a) - this.s * dy * sin(this.a);
    return this.y += this.s * dy * cos(this.a) + this.s * dx * sin(this.a);
  };
  Transformer.prototype.tint = function(c1, c2, c3, alpha){
    
    if(alpha!= null){
      this.alpha *= alpha;
    }
    if(c1!=null && c2!=null && c3!=null){
      this.tintColor[0]*= c1
      this.tintColor[1]*= c2
      this.tintColor[2]*= c3
    }
    
    const v1 = this.tintColor[0] * 255
    const v2 = this.tintColor[1] * 255
    const v3 = this.tintColor[2] * 255
    const a = this.alpha * 255
    tint(v1, v2, v3, a)
    return [this.tintColor, this.alpha]
  };
  return Transformer;

})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtZXIuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcdHJhbnNmb3JtZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBOztBQUFNO0VBQ1EscUJBQUMsQ0FBRCxFQUFPLENBQVAsRUFBYSxDQUFiLEVBQW1CLENBQW5CLEVBQXlCLEtBQXpCO0lBQUMsSUFBQyxDQUFBLGdCQUFELElBQUc7SUFBRyxJQUFDLENBQUEsZ0JBQUQsSUFBRztJQUFHLElBQUMsQ0FBQSxnQkFBRCxJQUFHO0lBQUcsSUFBQyxDQUFBLGdCQUFELElBQUc7SUFBRyxJQUFDLENBQUEsd0JBQUQsUUFBTztFQUFoQzs7d0JBQ2IsSUFBQSxHQUFPLFNBQUE7SUFDTixJQUFBLENBQUE7V0FDQSxJQUFDLENBQUEsS0FBSyxDQUFDLElBQVAsQ0FBWSxDQUFDLElBQUMsQ0FBQSxDQUFGLEVBQUksSUFBQyxDQUFBLENBQUwsRUFBTyxJQUFDLENBQUEsQ0FBUixFQUFVLElBQUMsQ0FBQSxDQUFYLENBQVo7RUFGTTs7d0JBR1AsR0FBQSxHQUFNLFNBQUE7QUFDTCxRQUFBO0lBQUEsR0FBQSxDQUFBO1dBQ0EsTUFBZ0IsSUFBQyxDQUFBLEtBQUssQ0FBQyxHQUFQLENBQUEsQ0FBaEIsRUFBQyxJQUFDLENBQUEsVUFBRixFQUFJLElBQUMsQ0FBQSxVQUFMLEVBQU8sSUFBQyxDQUFBLFVBQVIsRUFBVSxJQUFDLENBQUEsVUFBWCxFQUFBO0VBRks7O3dCQUdOLE1BQUEsR0FBUyxTQUFDLEVBQUQ7SUFDUixNQUFBLENBQU8sRUFBUDtXQUNBLElBQUMsQ0FBQSxDQUFELElBQU07RUFGRTs7d0JBR1QsS0FBQSxHQUFRLFNBQUMsRUFBRDtJQUNQLEtBQUEsQ0FBTSxFQUFOO1dBQ0EsSUFBQyxDQUFBLENBQUQsSUFBTTtFQUZDOzt3QkFHUixTQUFBLEdBQVksU0FBQyxFQUFELEVBQUksRUFBSjtJQUNYLFNBQUEsQ0FBVSxFQUFWLEVBQWEsRUFBYjtJQUNBLElBQUMsQ0FBQSxDQUFELElBQU0sSUFBQyxDQUFBLENBQUQsR0FBSyxFQUFMLEdBQVUsR0FBQSxDQUFJLElBQUMsQ0FBQSxDQUFMLENBQVYsR0FBb0IsSUFBQyxDQUFBLENBQUQsR0FBSyxFQUFMLEdBQVUsR0FBQSxDQUFJLElBQUMsQ0FBQSxDQUFMO1dBQ3BDLElBQUMsQ0FBQSxDQUFELElBQU0sSUFBQyxDQUFBLENBQUQsR0FBSyxFQUFMLEdBQVUsR0FBQSxDQUFJLElBQUMsQ0FBQSxDQUFMLENBQVYsR0FBb0IsSUFBQyxDQUFBLENBQUQsR0FBSyxFQUFMLEdBQVUsR0FBQSxDQUFJLElBQUMsQ0FBQSxDQUFMO0VBSHpCIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgVHJhbnNmb3JtZXJcclxuXHRjb25zdHJ1Y3RvcjogKEB4PTAsIEB5PTAsIEBhPTAsIEBzPTEsIEBzdGFjaz1bXSkgLT5cclxuXHRwdXNoIDogLT5cclxuXHRcdHB1c2goKVxyXG5cdFx0QHN0YWNrLnB1c2ggW0B4LEB5LEBhLEBzXVxyXG5cdHBvcCA6IC0+IFxyXG5cdFx0cG9wKClcclxuXHRcdFtAeCxAeSxAYSxAc10gPSBAc3RhY2sucG9wKClcclxuXHRyb3RhdGUgOiAoZGEpIC0+IFxyXG5cdFx0cm90YXRlIGRhXHJcblx0XHRAYSArPSBkYVxyXG5cdHNjYWxlIDogKGRzKSAtPiBcclxuXHRcdHNjYWxlIGRzXHJcblx0XHRAcyAqPSBkc1xyXG5cdHRyYW5zbGF0ZSA6IChkeCxkeSkgLT4gXHJcblx0XHR0cmFuc2xhdGUgZHgsZHlcclxuXHRcdEB4ICs9IEBzICogZHggKiBjb3MoQGEpIC0gQHMgKiBkeSAqIHNpbihAYSlcclxuXHRcdEB5ICs9IEBzICogZHkgKiBjb3MoQGEpICsgQHMgKiBkeCAqIHNpbihAYSlcclxuXHRcdFxyXG4iXX0=
//# sourceURL=C:\github\Transformer\coffee\transformer.coffee